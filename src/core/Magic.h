#pragma once

#include "core/Bitboard.h"

#include <array>
#include <cstdint>

namespace pali {

struct MagicEntry {
  Bitboard Mask;
  uint64_t Magic;
  int Shift;

  constexpr MagicEntry(Bitboard Mask, uint64_t Magic, int Shift)
      : Mask(Mask), Magic(Magic), Shift(Shift) {}

  int magicIndex(Bitboard Occ) const {
    Occ &= Mask;
    Occ *= Magic;
    Occ >>= Shift;

    return Occ;
  }
};

constexpr std::array<MagicEntry, 64> BISHOP_MAGIC = {
    MagicEntry(0x40201008040200, 0xffedf9fd7cfcffff, 58),
    {0x402010080400, 0xfc0962854a77f576, 59},
    {0x4020100a00, 0x5822022042000000, 59},
    {0x40221400, 0x2ca804a100200020, 59},
    {0x2442800, 0x204042200000900, 59},
    {0x204085000, 0x2002121024000002, 59},
    {0x20408102000, 0xfc0a66c64a7ef576, 59},
    {0x2040810204000, 0x7ffdfdfcbd79ffff, 58},
    {0x20100804020000, 0xfc0846a64a34fff6, 59},
    {0x40201008040000, 0xfc087a874a3cf7f6, 59},
    {0x4020100a0000, 0x1001080204002100, 59},
    {0x4022140000, 0x1810080489021800, 59},
    {0x244280000, 0x62040420010a00, 59},
    {0x20408500000, 0x5028043004300020, 59},
    {0x2040810200000, 0xfc0864ae59b4ff76, 59},
    {0x4081020400000, 0x3c0860af4b35ff76, 59},
    {0x10080402000200, 0x73c01af56cf4cffb, 59},
    {0x20100804000400, 0x41a01cfad64aaffc, 59},
    {0x4020100a000a00, 0x40c0422080a0598, 57},
    {0x402214001400, 0x4228020082004050, 57},
    {0x24428002800, 0x200800400e00100, 57},
    {0x2040850005000, 0x20b001230021040, 57},
    {0x4081020002000, 0x7c0c028f5b34ff76, 59},
    {0x8102040004000, 0xfc0a028e5ab4df76, 59},
    {0x8040200020400, 0x20208050a42180, 59},
    {0x10080400040800, 0x1004804b280200, 59},
    {0x20100a000a1000, 0x2048020024040010, 57},
    {0x40221400142200, 0x102c04004010200, 55},
    {0x2442800284400, 0x20408204c002010, 55},
    {0x4085000500800, 0x2411100020080c1, 57},
    {0x8102000201000, 0x102a008084042100, 59},
    {0x10204000402000, 0x941030000a09846, 59},
    {0x4020002040800, 0x244100800400200, 59},
    {0x8040004081000, 0x4000901010080696, 59},
    {0x100a000a102000, 0x280404180020, 57},
    {0x22140014224000, 0x800042008240100, 55},
    {0x44280028440200, 0x220008400088020, 55},
    {0x8500050080400, 0x4020182000904c9, 57},
    {0x10200020100800, 0x23010400020600, 59},
    {0x20400040201000, 0x41040020110302, 59},
    {0x2000204081000, 0xdcefd9b54bfcc09f, 59},
    {0x4000408102000, 0xf95ffa765afd602b, 59},
    {0xa000a10204000, 0x1401210240484800, 57},
    {0x14001422400000, 0x22244208010080, 57},
    {0x28002844020000, 0x1105040104000210, 57},
    {0x50005008040200, 0x2040088800c40081, 57},
    {0x20002010080400, 0x43ff9a5cf4ca0c01, 59},
    {0x40004020100800, 0x4bffcd8e7c587601, 59},
    {0x20408102000, 0xfc0ff2865334f576, 59},
    {0x40810204000, 0xfc0bf6ce5924f576, 59},
    {0xa1020400000, 0x80000b0401040402, 59},
    {0x142240000000, 0x20004821880a00, 59},
    {0x284402000000, 0x8200002022440100, 59},
    {0x500804020000, 0x9431801010068, 59},
    {0x201008040200, 0xc3ffb7dc36ca8c89, 59},
    {0x402010080400, 0xc3ff8a54f4ca2c89, 59},
    {0x2040810204000, 0xfffffcfcfd79edff, 58},
    {0x4081020400000, 0xfc0863fccb147576, 59},
    {0xa102040000000, 0x40c000022013020, 59},
    {0x14224000000000, 0x2000104000420600, 59},
    {0x28440200000000, 0x400000260142410, 59},
    {0x50080402000000, 0x800633408100500, 59},
    {0x20100804020000, 0xfc087e8e4bb2f736, 59},
    {0x40201008040200, 0x43ff9e4ef4ca2c89, 58}};

constexpr std::array<MagicEntry, 64> ROOK_MAGIC = {
    MagicEntry(0x101010101017e, 0xa180022080400230, 52),
    {0x202020202027c, 0x40100040022000, 53},
    {0x404040404047a, 0x80088020001002, 53},
    {0x8080808080876, 0x80080280841000, 53},
    {0x1010101010106e, 0x4200042010460008, 53},
    {0x2020202020205e, 0x4800a0003040080, 53},
    {0x4040404040403e, 0x400110082041008, 53},
    {0x8080808080807e, 0x8000a041000880, 52},
    {0x1010101017e00, 0x10138001a080c010, 53},
    {0x2020202027c00, 0x804008200480, 54},
    {0x4040404047a00, 0x10011012000c0, 54},
    {0x8080808087600, 0x22004128102200, 54},
    {0x10101010106e00, 0x200081201200c, 54},
    {0x20202020205e00, 0x202a001048460004, 54},
    {0x40404040403e00, 0x81000100420004, 54},
    {0x80808080807e00, 0x4000800380004500, 53},
    {0x10101017e0100, 0x208002904001, 53},
    {0x20202027c0200, 0x90004040026008, 54},
    {0x40404047a0400, 0x208808010002001, 54},
    {0x8080808760800, 0x2002020020704940, 54},
    {0x101010106e1000, 0x8048010008110005, 54},
    {0x202020205e2000, 0x6820808004002200, 54},
    {0x404040403e4000, 0xa80040008023011, 54},
    {0x808080807e8000, 0xb1460000811044, 53},
    {0x101017e010100, 0x4204400080008ea0, 53},
    {0x202027c020200, 0xb002400180200184, 54},
    {0x404047a040400, 0x2020200080100380, 54},
    {0x8080876080800, 0x10080080100080, 54},
    {0x1010106e101000, 0x2204080080800400, 54},
    {0x2020205e202000, 0xa40080360080, 54},
    {0x4040403e404000, 0x2040604002810b1, 54},
    {0x8080807e808000, 0x8c218600004104, 53},
    {0x1017e01010100, 0x8180004000402000, 53},
    {0x2027c02020200, 0x488c402000401001, 54},
    {0x4047a04040400, 0x4018a00080801004, 54},
    {0x8087608080800, 0x1230002105001008, 54},
    {0x10106e10101000, 0x8904800800800400, 54},
    {0x20205e20202000, 0x42000c42003810, 54},
    {0x40403e40404000, 0x8408110400b012, 54},
    {0x80807e80808000, 0x18086182000401, 53},
    {0x17e0101010100, 0x2240088020c28000, 53},
    {0x27c0202020200, 0x1001201040c004, 54},
    {0x47a0404040400, 0xa02008010420020, 54},
    {0x8760808080800, 0x10003009010060, 54},
    {0x106e1010101000, 0x4008008008014, 54},
    {0x205e2020202000, 0x80020004008080, 54},
    {0x403e4040404000, 0x282020001008080, 54},
    {0x807e8080808000, 0x50000181204a0004, 53},
    {0x7e010101010100, 0x48fffe99fecfaa00, 53},
    {0x7c020202020200, 0x48fffe99fecfaa00, 54},
    {0x7a040404040400, 0x497fffadff9c2e00, 54},
    {0x76080808080800, 0x613fffddffce9200, 54},
    {0x6e101010101000, 0xffffffe9ffe7ce00, 54},
    {0x5e202020202000, 0xfffffff5fff3e600, 54},
    {0x3e404040404000, 0x10301802830400, 54},
    {0x7e808080808000, 0x510ffff5f63c96a0, 53},
    {0x7e01010101010100, 0xebffffb9ff9fc526, 52},
    {0x7c02020202020200, 0x61fffeddfeedaeae, 53},
    {0x7a04040404040400, 0x53bfffedffdeb1a2, 53},
    {0x7608080808080800, 0x127fffb9ffdfb5f6, 53},
    {0x6e10101010101000, 0x411fffddffdbf4d6, 53},
    {0x5e20202020202000, 0x801000804000603, 53},
    {0x3e40404040404000, 0x3ffef27eebe74, 53},
    {0x7e80808080808000, 0x7645fffecbfea79e, 52}};

} // namespace pali
